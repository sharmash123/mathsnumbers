<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Number-Cal: Store</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gray-100 font-poppins store-body">
    <header class="bg-gray-800 text-white p-4 flex justify-between items-center flex-wrap">
        <h1 class="text-xl md:text-2xl font-bold mb-2 md:mb-0">Number-Cal: Store</h1>
        <nav class="flex gap-4">
            <a href="home.html" class="bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 px-4 rounded-full transition-colors duration-300">
                Home
            </a>
            <a href="index.html" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-full transition-colors duration-300">
                Back to Charts
            </a>
            <a href="info.html" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-full transition-colors duration-300">
                View Tables
            </a>
        </nav>
    </header>
    <div class="container mx-auto p-4 md:p-8">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-2xl font-semibold">Your Saved Charts</h2>
            <button id="delete-all-btn" class="bg-red-500 text-white py-2 px-4 rounded hover:bg-red-600 transition-colors duration-300">
                Delete All Charts
            </button>
        </div>
        <div id="chart-list" class="space-y-4">
            <!-- Charts will be dynamically added here -->
        </div>
    </div>
    <script>
        const chartList = document.getElementById('chart-list');
        const deleteAllBtn = document.getElementById('delete-all-btn');
        
        function renderChartList() {
            chartList.innerHTML = '';
            const history = JSON.parse(localStorage.getItem('chartHistory')) || {};
            const chartLabels = Object.keys(history).sort();

            if (chartLabels.length === 0) {
                chartList.innerHTML = `<p class="text-center text-gray-500">No charts saved yet. Go to the Charts page to create one!</p>`;
                deleteAllBtn.classList.add('hidden');
                return;
            }

            deleteAllBtn.classList.remove('hidden');
            chartLabels.forEach(label => {
                const chartItem = document.createElement('div');
                chartItem.className = 'bg-white p-4 rounded-lg shadow-lg flex justify-between items-center transition-all duration-300 ease-in-out chart-item animate-fadeIn';
                
                const editButton = document.createElement('button');
                editButton.className = 'font-semibold text-lg flex items-center gap-2 cursor-pointer text-blue-600 hover:text-blue-800 transition-colors duration-300';
                editButton.innerHTML = `<span class="chart-label">${label}</span> <svg class="h-5 w-5 edit-icon transition-transform duration-300" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828zM14 8.242L11.758 6 15 2.758 17.242 5 14 8.242zM5 11h2v2H5v-2zM4 14v4a2 2 0 002 2h8a2 2 0 002-2v-4h-2v4H6v-4H4z"/></svg>`;
                editButton.onclick = () => {
                    localStorage.setItem('chartToLoad', label);
                    window.location.href = 'index.html';
                };
                
                const deleteButton = document.createElement('button');
                deleteButton.className = 'bg-red-500 text-white py-1 px-3 rounded hover:bg-red-600 transition-colors duration-300';
                deleteButton.textContent = 'Delete';
                deleteButton.onclick = (e) => {
                    e.stopPropagation();
                    const confirmDelete = confirm(`Are you sure you want to delete the chart "${label}"?`);
                    if (confirmDelete) {
                        deleteChart(label);
                    }
                };

                chartItem.appendChild(editButton);
                chartItem.appendChild(deleteButton);
                chartList.appendChild(chartItem);
            });
        }

        function deleteChart(label) {
            const history = JSON.parse(localStorage.getItem('chartHistory')) || {};
            delete history[label];
            localStorage.setItem('chartHistory', JSON.stringify(history));
            renderChartList();
        }
        
        deleteAllBtn.addEventListener('click', () => {
            const confirmDelete = confirm("Are you sure you want to delete ALL your saved charts? This action cannot be undone.");
            if (confirmDelete) {
                localStorage.removeItem('chartHistory');
                renderChartList();
            }
        });

        renderChartList();
    </script>
</body>
</html>